<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>StepOnPlateau.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">java-machine-learning</a> &gt; <a href="index.source.html" class="el_package">com.jml.optimizers</a> &gt; <span class="el_source">StepOnPlateau.java</span></div><h1>StepOnPlateau.java</h1><pre class="source lang-java linenums">package com.jml.optimizers;


/**
 * StepOnPlateau is a {@link Scheduler} which &quot;steps&quot; the learning rate whenever the loss stops significantly decreasing
 * for a specified number of epochs.&lt;br&gt;&lt;br&gt;
 *
 * The step is computed by a factor. i.e.
 * &lt;pre&gt;
 *      learning_rate = learning_rate * factor
 * &lt;/pre&gt;
 *
 *
 * The default step factor is 0.5. &lt;br&gt;
 * The default patience is 2 iterations.&lt;br&gt;
 * The default threshold is 1e-4.
 */
public class StepOnPlateau extends Scheduler {
    // Default hyper-parameter values.
<span class="nc" id="L20">    private final double DEFAULT_FACTOR = 0.5;</span>
<span class="nc" id="L21">    private final int DEFAULT_PATIENCE = 2;</span>
<span class="nc" id="L22">    private final double DEFAULT_THRESHOLD = this.threshold = 1e-4;;</span>

    double factor; // Factor to multiply learning rate by.
    int patience; // Number of epochs to wait before stepping the learning rate

    /* Threshold for measuring a 'significant' change in the loss. If the change in the loss is less than
    the threshold for &lt;patience&gt; number of epochs, then the learning rate will be stepped. */
    double threshold;


    /**
     * Creates a StepOnPlateau {@link Scheduler} with default factor=0.8 and patience=2.
     */
<span class="nc" id="L35">    public StepOnPlateau() {</span>
<span class="nc" id="L36">        factor = DEFAULT_FACTOR;</span>
<span class="nc" id="L37">        patience = DEFAULT_PATIENCE;</span>
<span class="nc" id="L38">        this.threshold = DEFAULT_THRESHOLD;</span>
<span class="nc" id="L39">    }</span>


    /**
     * Creates a StepOnPlateau {@link Scheduler} with specified factor.
     * The patience will default to 2.
     *
     * @param factor Factor to step the learning rate by.
     */
<span class="nc" id="L48">    public StepOnPlateau(double factor) {</span>
<span class="nc" id="L49">        this.factor = factor;</span>
<span class="nc" id="L50">        patience = DEFAULT_PATIENCE;</span>
<span class="nc" id="L51">        this.threshold = DEFAULT_THRESHOLD;</span>
<span class="nc" id="L52">    }</span>


    /**
     * Creates a StepOnPlateau {@link Scheduler} with specified factor and patience.
     *
     * @param factor Factor to step the learning rate by.
     * @param patience Number of epochs to wait before applying the step.
     */
<span class="nc" id="L61">    public StepOnPlateau(double factor, int patience) {</span>
<span class="nc" id="L62">        this.factor = factor;</span>
<span class="nc" id="L63">        this.patience = patience;</span>
<span class="nc" id="L64">        this.threshold = DEFAULT_THRESHOLD;</span>
<span class="nc" id="L65">    }</span>


    /**
     * Creates a StepOnPlateau {@link Scheduler} with specified factor, patience and threshold.
     *
     * @param factor Factor to step the learning rate by.
     * @param patience Number of epochs to wait before applying the step.
     * @param threshold The
     */
<span class="nc" id="L75">    public StepOnPlateau(double factor, int patience, double threshold) {</span>
<span class="nc" id="L76">        this.factor = factor;</span>
<span class="nc" id="L77">        this.patience = patience;</span>
<span class="nc" id="L78">        this.threshold = threshold;</span>
<span class="nc" id="L79">    }</span>


    /**
     * {@inheritDoc}
     */
    @Override
    public void step() {
        // TODO:
<span class="nc" id="L88">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>